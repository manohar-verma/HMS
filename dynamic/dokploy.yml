http:
  routers:
    # ACME challenge router (must have highest priority)
    acme-http:
      rule: PathPrefix(`/.well-known/acme-challenge/`)
      entryPoints:
        - web
      service: acme-service
      priority: 9999

    # HTTP router with redirect
    stayhub360-http:
      rule: Host(`stayhub360.com`)
      entryPoints:
        - web
      service: stayhub360-service
      middlewares:
        - redirect-to-https
      priority: 100

    # HTTPS router
    stayhub360-router:
      rule: Host(`stayhub360.com`)
      entryPoints:
        - websecure
      service: stayhub360-service
      tls:
        certResolver: letsencrypt
      priority: 200

  services:
    stayhub360-service:
      loadBalancer:
        servers:
          - url: http://laravel_nginx:80
        passHostHeader: true

    acme-service:
      loadBalancer:
        servers:
          - url: http://127.0.0.1

  middlewares:
    redirect-to-https:
      redirectScheme:
        scheme: https
        permanent: true